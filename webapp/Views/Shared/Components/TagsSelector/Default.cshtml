@{
    var available = ViewBag.AvailableTags as HashSet<string> ?? new HashSet<string>(StringComparer.OrdinalIgnoreCase);
    var selected = ViewBag.SelectedTags as HashSet<string> ?? new HashSet<string>(StringComparer.OrdinalIgnoreCase);
    // Ensure a hard cap of 10 tags on UI and stable alphabetical order
    var toShow = available.OrderBy(t => t, StringComparer.OrdinalIgnoreCase).Take(10).ToArray();
}

<div class="tags-selector" role="group" aria-label="Tags">
    @foreach (var tag in toShow)
    {
        var inputId = $"tag_{tag.Replace(" ", "_")}";
        <span class="tag-item">
            <input class="tag-checkbox" type="checkbox" name="tags" value="@tag" id="@inputId"
                   @(selected.Contains(tag) ? "checked" : null) />
            <label class="tag-chip" for="@inputId">@tag</label>
        </span>
    }
    @if (!toShow.Any())
    {
        <span class="text-muted">No tags available</span>
    }
</div>
